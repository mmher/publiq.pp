module BlockchainMessage
{
    //  standard socket messages
    type Join {}
    type Drop {}
    type Error {}

    //  dummy, testing
    class Hellow
    {
        String text
        UInt64 index
    }

    //  container messages
    class Broadcast
    {
        Object value
    }

    //  special testing shutdown message
    class Shutdown {}

    ///
    /// RPC interface
    ///
    //  response codes
    class Done {}
    class Failed
    {
        String message
    }
    //  GetChainInfo request, response should be ChainInfo
    class GetChainInfo {}

    //  ChainInfo
    class ChainInfo
    {
        UInt64 length
    }

    //  request to calculate the checksum
    class CalculateChecksum
    {
        Object value
    }

    class Checksum
    {
        String sha256_2x
    }
    // .
    // .
    class GetActions
    {
        UInt64 start_index
    }

    class Action
    {
        UInt64 index
        Object item
    }

    class Actions
    {
        Array Action list
    }
    // .
    //  save HTTPObject in distributed storage, response
    //  will be Checksum
    class HTTPObject
    {
        String mimetype
        String body
    }

    //  response will be HTTPObject
    class GetFromStorage
    {
        Checksum path
    }

    //  this is admin tool for RPC testing
    class SubmitActions
    {
        Object item
    }

    class Bin64
    {
        String value
    }

    class TransactionHash
    {
        Bin64 value
        UInt64 block_index
    }

    class Address
    {
        String public_key
    }

    class Coin
    {
        UInt64 value
    }

    class Transaction
    {
        TimePoint tm
        UInt64 nonce
        Coin fee
        Object obj
    }

    class SignedTransaction
    {
        Array TransactionHash inputs
        Transaction obj
        String signature
    }

    class Transfer
    {
        Address from
        Coin amount
        Address to
    }

    class RevertActionAt
    {
        UInt64 index
    }

    class RevertLastAction {}

    //  .
    class Reward
    {
        Coin amount
        Address to
    }

    //  .
    class NewArticle
    {
        String title
        Array String hash
    }
}
